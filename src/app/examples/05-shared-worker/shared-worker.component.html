<div class="example-content">
  <h1>{{ texts().title }}</h1>
  <p class="subtitle">{{ texts().subtitle }}</p>

  <app-info-box [title]="texts().infoTitle">
    {{ texts().infoDescription }}
  </app-info-box>

  <div class="warning-box">
    {{ texts().compatibilityNote?.title }}
    {{ texts().compatibilityNote?.details }}
  </div>

  <app-code-explanation [summaryText]="texts().codeSummary">
    <app-code-section [title]="texts().codeSections?.createSharedWorker">
      <pre><code>const sharedWorker = new SharedWorker('shared_worker.js');
const port = sharedWorker.port;
port.start();</code></pre>
    </app-code-section>
    <app-code-section [title]="texts().codeSections?.connectAndSend">
      <pre><code>port.postMessage({{'{'}}
    type: 'message',
    tabId: 'tab-123',
    message: 'Hola desde pesta√±a 1'
{{ '}' }});</code></pre>
    </app-code-section>
  </app-code-explanation>

  <div class="status-panel">
    <h3>{{ texts().statusPanel?.title }}</h3>
    <div class="status-item">
      <span class="status-label">{{ texts().statusPanel?.statusLabel }}</span>
      <span class="status-value" [class.active]="workerStatus() === 'connected'">
        {{ texts().statusPanel?.statuses?.[workerStatus()] }}
      </span>
    </div>
    <div class="status-item">
      <span class="status-label">{{ texts().statusPanel?.tabIdLabel }}</span>
      <span class="status-value">{{ tabId() }}</span>
    </div>
    <div class="status-item">
      <span class="status-label">{{ texts().statusPanel?.connectedLabel }}</span>
      <span class="status-value">{{ connectedTabs() }}</span>
    </div>
  </div>

  <div class="message-panel">
    <h3>{{ texts().chatPanel?.title }}</h3>
    
    <div class="input-group">
      <input 
        type="text" 
        [placeholder]="texts().chatPanel?.placeholder"
        [value]="messageText()"
        (input)="messageText.set($any($event.target).value)"
        (keypress)="onKeyPress($event)"
      >
      <button (click)="sendMessage()">{{ texts().chatPanel?.sendButton }}</button>
    </div>

    <p class="instructions">
      {{ texts().chatPanel?.instructions }}
    </p>

    <div class="messages" [class.active]="messages().length > 0">
      @if (messages().length === 0) {
        <p class="empty-message">
          {{ texts().chatPanel?.emptyState }}
        </p>
      } @else {
        @for (msg of messages(); track $index) {
          <div class="message" [class.system]="msg.type === 'system'" [class.self]="msg.type === 'self'" [class.other]="msg.type === 'other'">
            <div class="sender">{{ msg.sender }}</div>
            <div class="text">{{ msg.text }}</div>
            <div class="timestamp">{{ msg.timestamp }}</div>
          </div>
        }
      }
    </div>
  </div>
</div>
