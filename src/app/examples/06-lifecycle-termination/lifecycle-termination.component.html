<div class="container">
  <h1>â™»ï¸ Ciclo de Vida y TerminaciÃ³n</h1>
  <p class="subtitle">Ejemplo 06: GestiÃ³n del ciclo de vida de Workers</p>

  <app-info-box title="ğŸ’¡ Â¿QuÃ© demuestra este ejemplo?">
    Es importante gestionar correctamente el ciclo de vida de los Workers para liberar recursos y memoria.
    Este ejemplo muestra cÃ³mo crear, usar y terminar Workers de forma apropiada.
  </app-info-box>

  <app-code-explanation summaryText="ğŸ“– Ver CÃ³digo - Â¿CÃ³mo funciona?">
    <app-code-section title="1ï¸âƒ£ Crear Worker">
      <pre><code>let worker = null;

function createWorker() {{'{'}}
    worker = new Worker('worker.js');
    worker.onmessage = handleMessage;
    worker.onerror = handleError;
{{ '}' }}</code></pre>
    </app-code-section>
    <app-code-section title="2ï¸âƒ£ Terminar Worker">
      <pre><code>function terminateWorker() {{'{'}}
    if (worker) {{'{'}}
        worker.terminate();
        worker = null;
    {{ '}' }}
{{ '}' }}</code></pre>
    </app-code-section>
  </app-code-explanation>

  <div class="control-panel">
    <h3>ğŸ® Control del Worker</h3>
    
    <div class="status-indicator" [class.inactive]="workerStatus() === 'none'" [class.active]="workerStatus() === 'created' || workerStatus() === 'working'" [class.working]="workerStatus() === 'working'">
      <div class="status-dot"></div>
      <span>{{ workerStatus() === 'none' ? 'Worker no creado' : workerStatus() === 'created' ? 'Worker listo' : workerStatus() === 'working' ? 'Procesando...' : 'Completado' }}</span>
    </div>

    <div class="button-grid">
      <button class="btn-create" (click)="createWorker()" [disabled]="workerStatus() !== 'none'">â• Crear Worker</button>
      <button class="btn-start" (click)="startTask()" [disabled]="workerStatus() !== 'created'">â–¶ï¸ Iniciar Tarea Larga</button>
      <button class="btn-terminate" (click)="terminateWorker()" [disabled]="workerStatus() === 'none'">ğŸ›‘ Terminar Worker</button>
      <button (click)="clearLogs()">ğŸ—‘ï¸ Limpiar Logs</button>
    </div>

    <div class="progress-bar" [style.display]="workerStatus() === 'working' ? 'block' : 'none'">
      <div class="progress-fill" [style.width.%]="progress()">{{ progress() }}%</div>
    </div>
  </div>

  <app-stats-panel title="ğŸ“Š EstadÃ­sticas" [stats]="getStats()"></app-stats-panel>

  <app-log-panel 
    [logs]="logs()" 
    title="ğŸ“‹ Log de Eventos"
    emptyMessage="Sistema iniciado. Esperando acciones..."
    (clear)="clearLogs()">
  </app-log-panel>
</div>
