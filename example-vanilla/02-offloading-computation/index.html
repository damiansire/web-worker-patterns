<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02 - Descarga de C√≥mputo Pesado</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>‚ö° Descarga de C√≥mputo Pesado</h1>
        <p class="subtitle">Ejemplo 04: Evitando el bloqueo de la UI</p>

        <div class="info-box">
            <strong>üí° ¬øQu√© demuestra este ejemplo?</strong>
            Calcula n√∫meros primos de forma intensiva. Prueba ambos botones y observa c√≥mo el contador
            y la animaci√≥n se comportan diferente cuando el c√°lculo se hace en el hilo principal vs. en un worker.
        </div>

        <details class="code-explanation">
            <summary>üìñ Ver C√≥digo - ¬øC√≥mo funciona?</summary>
            
            <div class="code-section">
                <h3>1Ô∏è‚É£ Crear Worker para C√≥mputo (main.js)</h3>
                <pre><code><span class="comment">// Crear worker para tareas pesadas</span>
<span class="keyword">const</span> <span class="variable">worker</span> = <span class="keyword">new</span> <span class="function">Worker</span>(<span class="string">'worker.js'</span>);</code></pre>
            </div>

            <div class="code-section">
                <h3>2Ô∏è‚É£ Enviar Tarea al Worker (main.js)</h3>
                <pre><code><span class="comment">// Enviar cantidad de primos a calcular</span>
<span class="keyword">const</span> <span class="variable">count</span> = <span class="number">50000</span>;
<span class="variable">worker</span>.<span class="function">postMessage</span>({ <span class="property">count</span>: <span class="variable">count</span> });</code></pre>
            </div>

            <div class="code-section">
                <h3>3Ô∏è‚É£ Procesar en Worker (worker.js)</h3>
                <pre><code><span class="comment">// El worker ejecuta el c√°lculo pesado</span>
<span class="variable">self</span>.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="variable">e</span>) {
    <span class="keyword">const</span> { <span class="variable">count</span> } = <span class="variable">e</span>.<span class="property">data</span>;
    
    <span class="comment">// C√°lculo intensivo (esto NO bloquea la UI)</span>
    <span class="keyword">const</span> <span class="variable">primes</span> = <span class="function">calculatePrimes</span>(<span class="variable">count</span>);
    
    <span class="comment">// Enviar resultado</span>
    <span class="variable">self</span>.<span class="function">postMessage</span>({ <span class="property">primes</span>: <span class="variable">primes</span> });
};</code></pre>
            </div>

            <div class="code-section">
                <h3>4Ô∏è‚É£ Recibir Resultado (main.js)</h3>
                <pre><code><span class="comment">// Recibir el resultado calculado</span>
<span class="variable">worker</span>.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="variable">e</span>) {
    <span class="keyword">const</span> <span class="variable">primes</span> = <span class="variable">e</span>.<span class="property">data</span>.<span class="property">primes</span>;
    <span class="variable">console</span>.<span class="function">log</span>(<span class="string">'C√°lculo completo:'</span>, <span class="variable">primes</span>);
};</code></pre>
            </div>

            <div class="code-flow">
                <h3>üîÑ Ventaja: UI No se Bloquea</h3>
                <div class="comparison">
                    <div class="comparison-item">
                        <h4>‚ùå Sin Worker</h4>
                        <p>‚Ä¢ UI se congela</p>
                        <p>‚Ä¢ Animaciones se detienen</p>
                        <p>‚Ä¢ Usuario no puede interactuar</p>
                    </div>
                    <div class="comparison-item success">
                        <h4>‚úÖ Con Worker</h4>
                        <p>‚Ä¢ UI permanece fluida</p>
                        <p>‚Ä¢ Animaciones contin√∫an</p>
                        <p>‚Ä¢ Usuario puede seguir interactuando</p>
                    </div>
                </div>
            </div>
        </details>

        <div class="demo-section">
            <h3>üî¢ Calculadora de N√∫meros Primos</h3>
            
            <div class="input-group">
                <label for="numberInput">¬øCu√°ntos n√∫meros primos calcular?</label>
                <input 
                    type="number" 
                    id="numberInput" 
                    value="50000" 
                    min="1000" 
                    max="100000"
                    step="1000"
                >
            </div>

            <div class="button-group">
                <button class="btn-worker" id="workerBtn">
                    üöÄ Calcular con Worker<br>
                    <small style="font-size: 11px; font-weight: normal;">(No bloquea la UI)</small>
                </button>
                <button class="btn-main" id="mainBtn">
                    üêå Calcular en Hilo Principal<br>
                    <small style="font-size: 11px; font-weight: normal;">(Bloquea la UI)</small>
                </button>
            </div>

            <div class="spinner" id="spinner"></div>
            <div id="result"></div>
        </div>

        <div class="ui-test">
            <h3 style="margin-bottom: 10px;">üéØ Prueba de Respuesta de la UI</h3>
            <p style="font-size: 14px; opacity: 0.9;">Si la UI est√° bloqueada, este contador se congelar√°</p>
            <div class="counter" id="counter">0</div>
            <div class="animation-box"></div>
            <p style="font-size: 12px; opacity: 0.8;">
                La caja deber√≠a seguir rebotando suavemente
            </p>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>

