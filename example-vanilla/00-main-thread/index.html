<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02 - Bloqueo del Main Thread</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>üîí Bloqueo del Main Thread</h1>
        <p class="subtitle">Ejemplo 02: El problema que resuelven los Web Workers</p>

        <div class="info-box warning">
            <strong>‚ö†Ô∏è ¬øQu√© demuestra este ejemplo?</strong>
            Este ejemplo muestra qu√© pasa cuando ejecutamos c√°lculos pesados directamente en el hilo principal.
            Observa c√≥mo la UI se congela completamente durante el c√°lculo de n√∫meros primos.
        </div>

        <details class="code-explanation">
            <summary>üìñ Ver C√≥digo - ¬øC√≥mo funciona?</summary>
            
            <div class="code-sections-list">
                <div class="code-section">
                    <h3>1Ô∏è‚É£ Funci√≥n de C√°lculo de N√∫meros Primos</h3>
                    <pre><code><span class="comment">// Funci√≥n que calcula n√∫meros primos de forma intensiva</span>
<span class="keyword">function</span> <span class="function">calculatePrimes</span>(<span class="variable">max</span>) {
    <span class="keyword">const</span> <span class="variable">primes</span> = [];
    
    <span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">i</span> = <span class="number">2</span>; <span class="variable">primes</span>.<span class="property">length</span> &lt; <span class="variable">max</span>; <span class="variable">i</span>++) {
        <span class="keyword">let</span> <span class="variable">isPrime</span> = <span class="keyword">true</span>;
        
        <span class="keyword">for</span> (<span class="keyword">let</span> <span class="variable">j</span> = <span class="number">2</span>; <span class="variable">j</span> &lt;= <span class="function">Math</span>.<span class="function">sqrt</span>(<span class="variable">i</span>); <span class="variable">j</span>++) {
            <span class="keyword">if</span> (<span class="variable">i</span> % <span class="variable">j</span> === <span class="number">0</span>) {
                <span class="variable">isPrime</span> = <span class="keyword">false</span>;
                <span class="keyword">break</span>;
            }
        }
        
        <span class="keyword">if</span> (<span class="variable">isPrime</span>) {
            <span class="variable">primes</span>.<span class="function">push</span>(<span class="variable">i</span>);
        }
    }
    
    <span class="keyword">return</span> <span class="variable">primes</span>;
}</code></pre>
                </div>

                <div class="code-section">
                    <h3>2Ô∏è‚É£ Ejecutar C√°lculo en el Main Thread</h3>
                    <pre><code><span class="comment">// Cuando hacemos clic en el bot√≥n...</span>
<span class="variable">calculateButton</span>.<span class="property">addEventListener</span>(<span class="string">'click'</span>, () => {
    <span class="comment">// El c√°lculo se ejecuta directamente en el hilo principal</span>
    <span class="keyword">const</span> <span class="variable">primes</span> = <span class="function">calculatePrimes</span>(<span class="number">50000</span>);
    
    <span class="comment">// ‚ö†Ô∏è Durante este c√°lculo, TODO se congela:</span>
    <span class="comment">// - La UI no responde</span>
    <span class="comment">// - Los contadores se detienen</span>
    <span class="comment">// - Las animaciones se pausan</span>
    <span class="comment">// - El usuario no puede interactuar</span>
});</code></pre>
                </div>

                <div class="code-section">
                    <h3>3Ô∏è‚É£ El Problema</h3>
                    <pre><code><span class="comment">// JavaScript es single-threaded</span>
<span class="comment">// Solo hay UN hilo principal que ejecuta:</span>
<span class="comment">// 1. C√≥digo JavaScript</span>
<span class="comment">// 2. Renderizado de la UI</span>
<span class="comment">// 3. Eventos del usuario</span>
<span class="comment">// 4. Animaciones</span>

<span class="comment">// Si el hilo est√° ocupado calculando,</span>
<span class="comment">// NADA M√ÅS puede ejecutarse</span>

<span class="comment">// üí° Soluci√≥n: Web Workers</span>
<span class="comment">// Los Web Workers ejecutan c√≥digo en un hilo separado</span>
<span class="comment">// y permiten que el main thread siga respondiendo</span></code></pre>
                </div>
            </div>
        </details>

        <div class="demo-section">
            <h3>üî¢ Calculadora de N√∫meros Primos (Main Thread)</h3>
            
            <div class="input-group">
                <label for="numberInput">¬øCu√°ntos n√∫meros primos calcular?</label>
                <input 
                    type="number" 
                    id="numberInput" 
                    value="50000" 
                    min="1000" 
                    max="100000"
                    step="1000"
                >
            </div>

            <button id="calculateButton">
                üîí Calcular en Main Thread<br>
                <small style="font-size: 11px; font-weight: normal;">(La UI se bloquear√°)</small>
            </button>

            <div class="spinner" id="spinner"></div>
            <div id="result"></div>
        </div>

        <div class="ui-test">
            <h3 style="margin-bottom: 10px;">üéØ Prueba de Respuesta de la UI</h3>
            <p style="font-size: 14px; opacity: 0.9;">Si la UI est√° bloqueada, este contador se congelar√°</p>
            <div class="counter" id="counter">0</div>
            <div class="animation-box"></div>
            <p style="font-size: 12px; opacity: 0.8;">
                La caja deber√≠a seguir rebotando suavemente
            </p>
            <div class="warning" style="margin-top: 15px; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px;">
                <strong>‚ö†Ô∏è Prueba esto:</strong> Haz clic en "Calcular" y observa c√≥mo el contador se congela completamente.
                Esto es exactamente el problema que los Web Workers resuelven.
            </div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>

